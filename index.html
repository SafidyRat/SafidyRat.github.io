<!DOCTYPE html>
<html>
<head>
  <style>


.button {
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
}

.button2 {background-color: #008CBA;} /* Blue */

.menu{
  margin-right: 10 px;
}



  </style>
<meta charset="utf-8">
<title>Pre-process IMAGE</title>
<script src="js/Vert_Hort_line_clean.js"></script>
<script src="js/roundslider.js"></script>

<link rel="stylesheet" href="css/slider.css">
<link rel="stylesheet" href="css/roundlider.css">

</head>
<body>
<h2>Pre-process IMAGE</h2>
<p id="status">OpenCV.js is loading...</p>
<div>
  <div>
    <input type="checkbox" id="chKh" name="Kh_active" > Detecte Horizontal Line
  </div>
  <div>
    <input type="checkbox" id="chKv" name="Kv_active" >Detecte Verticale Line
  </div>

  <div class="row">

  <div class="round-slider each">
    <div class="selection" name="00Kh00" style=""></div>
    <div class="holder" style="color: hsl(120, 100%, 50%);">10</div><br>
      Horizontal line detection parametre
  </div>


  
  <div class="round-slider each">
    <div class="selection" name="00Khrepaire00"style=""></div>
    <div class="holder" style="color: hsl(120, 100%, 50%);">50</div><br>
    Repaire broken Horizontal line
  </div>

  <div class="round-slider each">
    <div class="selection"name="00Kv00" style=""></div>
    <div class="holder" style="color: hsl(120, 100%, 50%);">5</div><br>
    Vertical line detection parametre
  </div>

  <div class="round-slider each">
    <div class="selection" name="00Kvrepaire00"style=""></div>
    <div class="holder" style="color: hsl(120, 100%, 50%);">50</div><br>
    Repaire broken Vertical line
  </div>


  <div class="round-slider each">
    <div class="selection" name="00line_withd00"style=""></div>
    <div class="holder" style="color: hsl(120, 100%, 50%);">100</div><br>
    Contour line width
  </div>

  <div class="round-slider each">
    <div class="selection" name="00perimetre"style=""></div>
    <div class="holder" style="color: hsl(120, 100%, 50%);">100</div><br>
    Filter detected line by  perimetre
    
  </div>

</div>

  <div class="inputoutput">
    <img id="imageSrc" alt="No Image" />
    <div class="caption">Load file to digitize <input type="file" id="fileInput" name="file" /></div>

  

    
  </div><br><br><br>



 



  
   <!-- 
  <div class="range-slider">
    <input class="range-slider__range" id ="Kh"type="range" value="25" min="5" max="500">
    <span class="range-slider__value">25</span>Kernel Window for Horitontal line detection
  </div>
  -->
  
  








  




 
  <div>
    <button onclick="download()" class="button button2">DIGITIZE</button>
  </div>

  <div class="inputoutput">
    <canvas id="originale_image" ></canvas>
    <canvas id="Horizontale_line" ></canvas>
    <canvas id="verticale_line" ></canvas>
    <canvas id="Extracted_curve" ></canvas><br><br>
    <div class="me"> By Safidy Ratolonandrasana</div>
  </div>
</div>
<script type="text/javascript" >

  document.getElementById("chKh").click();
  document.getElementById("chKv").click();

  //clear

  var allcanvas=[];
  allcanvas=[document.getElementById("riginale_image"), 
  document.getElementById("Horizontale_line"),
  document.getElementById("verticale_line"),
  document.getElementById("Extracted_curve")];


for(let i=0; i<=allcanvas.length; i++){

  if(allcanvas[i]!=null){
  
  var context = allcanvas[i].getContext('2d');
  // do some drawing
  context.clearRect(0, 0, allcanvas[i].width, allcanvas[i].height);
  }
}
 

  function  download (){

 var canvass=document.getElementById("Extracted_curve");
localStorage.setItem("canvasOutput", canvass.toDataURL());


  var link = document.createElement('a');
  link.download = 'D:\2022\chart\testdownload\filename.png';
  link.href = document.getElementById('Extracted_curve').toDataURL();
  //link.click();

  window.location = 'dev.html';
}

let imgElement = document.getElementById('imageSrc');
let inputElement = document.getElementById('fileInput');
inputElement.addEventListener('change', (e) => {
  imgElement.src = URL.createObjectURL(e.target.files[0]);
}, false);
imgElement.onload = function() {


  roundslider();
  var v1=[50,300,35,300,1,5];
  line_cleanign(v1[0],v1[1],v1[2],v1[3],v1[4],v1[5]);
  



};





function onOpenCvReady() {
  document.getElementById('status').innerHTML = 'Ready';
}



</script>
<script async src="./javascript/opencv.js" onload="onOpenCvReady();" type="text/javascript"></script>
</body>
</html>
